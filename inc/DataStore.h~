#ifndef DIFF_DATASTORE_H
#define DIFF_DATASTORE_H

#include "Pulse.h"
#include "IDataBlock.h"
#include <map>
#include <vector>


class DataStore:public IDataBlock{
	public:
		bool regist(std::string name, IDataBlock* data){m_map.insert(make_pair(name, data));}
		IDataBlock* find(std::string name){ return m_map[name] ;}
		vector<std::string> list();
		bool mkdir(std::string name);
		DataStore* cd(std::string name);
	private:
		std::map<std::string, IDataBlock* > m_map;	
		std::string m_path;


};

typedef boost::shared_ptr<DataStore> DataStorePtr;

vector<std::string> DataStore::list(){
	std::map<std::string, IDataBlock*>::iterator it;
	vector<std::string> objs;
	for(it = m_map.begin(); it != m_map.end(); it++){
		objs.push_back(it->first);
	}
	return objs;
};

bool DataStore::mkdir(std::string name){
	if(not m_map[name]){
		DataStore* ds = new DataStore();
		this->regist(name, ds);
		std::cout << name << " make " << m_map[name] << std::endl;
		return 1;
	}else{
		std::cout << name << " has already existed!" << std::endl;
		return 0;
	}
}

DataStore* DataStore::cd(std::string name){
       return dynamic_cast<DataStore*>(this->find(name));
}

#endif
